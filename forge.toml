# Forge Code Mode MCP Gateway — Pre-production Configuration
#
# This config wires narsil-mcp (code intelligence) and arbiter (security testing)
# through the Forge gateway. All tool calls flow through the sandboxed V8 executor.

[servers.narsil]
command = "narsil-mcp"
args = ["--repos", ".", "--git", "--call-graph", "--persist", "--watch", "--streaming"]
transport = "stdio"
description = "Code intelligence — symbols, search, call graphs, security scanning, dependency analysis"

[servers.arbiter]
command = "arbiter"
args = ["serve", "--stdio"]
transport = "stdio"
description = "Security testing — vulnerability discovery, traffic analysis, prompt injection scanning"

[sandbox]
timeout_secs = 120          # Security scans and deep analysis chains can run long
max_heap_mb = 512           # Room for large scan results and dependency trees
max_concurrent = 16         # Parallel execution slots (lightweight in child_process mode)
max_tool_calls = 500        # Multi-step analysis chains (scan → analyse → cross-ref → report)
execution_mode = "child_process"  # Production isolation (separate V8 process)
